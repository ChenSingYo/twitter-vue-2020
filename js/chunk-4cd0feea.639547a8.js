(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4cd0feea"],{"064f":function(e,s,t){},"1bb4":function(e,s,t){"use strict";t.r(s);var n=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"private-room"},[t("NavSidebar"),t("UserMessageListChatRoom",{attrs:{users:e.userList},on:{"after-selected-user":e.afterSelectedUserHandle}}),t("ChatRoom",{attrs:{"inital-connecting-user":e.connectingUser,"inital-messages":e.messages,"current-user":e.currentUser,"is-show-chatroom":e.isShowChatroom},on:{"after-send-message":e.afterSendMessageHandle,"after-leave-room":e.afterLeaveRoomHandle}})],1)},a=[],i=t("6b75");function o(e){if(Array.isArray(e))return Object(i["a"])(e)}t("a4d3"),t("e01a"),t("d3b7"),t("d28b"),t("3ca3"),t("ddb0"),t("a630");function r(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}var c=t("06c5");function l(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function d(e){return o(e)||r(e)||Object(c["a"])(e)||l()}var u=t("5530"),m=t("2f62"),h=t("bb41"),g=function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"chart-room"},[t("header",{staticClass:"header"},[t("div",{staticClass:"title"},[e._v("訊息")]),t("div",{staticClass:"add-message"},[t("unicon",{attrs:{name:"add-message",viewBox:"0 0 512 512",width:"22px",height:"22px"}})],1)]),t("section",{staticClass:"user-list"},e._l(e.users,(function(s){return t("div",{key:s.id,staticClass:"user-list-container",on:{click:function(t){return e.selectedUserHandle(s)}}},[t("div",{staticClass:"img-wrapper"},[t("img",{attrs:{src:s.avatar,alt:""}})]),t("div",{staticClass:"info-container"},[t("span",{staticClass:"name"},[e._v(e._s(s.name))]),t("span",{staticClass:"account"},[e._v(e._s(s.account))]),t("p",{staticClass:"message"},[e._v(" "+e._s(s.text)+" ")])]),t("div",{staticClass:"last-time"},[e._v(" "+e._s(s.time)+" ")])])})),0)])},f=[],v={name:"UserMessageListChatRoom",props:{users:{type:Array}},methods:{selectedUserHandle:function(e){console.log(e),this.$emit("after-selected-user",e)}}},C=v,p=(t("2a0d"),t("2877")),b=Object(p["a"])(C,g,f,!1,null,"4a728c92",null),U=b.exports,_=function(){var e=this,s=e.$createElement,n=e._self._c||s;return n("div",{staticClass:"chat-room"},[e.isShowChatroom?[n("header",{staticClass:"header"},[n("div",{staticClass:"name"},[e._v(e._s(e.connectingUser.username))]),n("div",{staticClass:"account"},[e._v(e._s(e.connectingUser.account))]),n("div",{staticClass:"close",on:{click:e.leaveRoomHandle}},[n("unicon",{attrs:{name:"multiply",fill:"#ff6600"}})],1)]),n("section",{ref:"messageBody",staticClass:"message-body"},[n("div",{staticClass:"fix"}),e._l(e.messages,(function(s){return n("div",{key:s.ChatId,ref:"messageContainer",refInFor:!0,staticClass:"message-container"},[s.UserId===e.currentUser.id?[n("div",{staticClass:"self-message-container"},[n("div",{staticClass:"message"},[e._v(e._s(s.text))]),n("div",{staticClass:"send-time"},[e._v(e._s(s.time))])])]:[n("div",{staticClass:"other-message-container"},[e._m(0,!0),n("div",{staticClass:"info-container"},[n("div",{staticClass:"message"},[e._v(e._s(s.text))]),n("div",{staticClass:"send-time"},[e._v(e._s(s.time))])])])]],2)}))],2),n("section",{staticClass:"send-message"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.sendMessage,expression:"sendMessage"}],staticClass:"text-input",attrs:{type:"text",name:"",placeholder:"輸入訊息..."},domProps:{value:e.sendMessage},on:{input:function(s){s.target.composing||(e.sendMessage=s.target.value)}}}),n("button",{staticClass:"send-btn",attrs:{type:"submit"}},[n("img",{attrs:{src:t("f2ec"),alt:"send"},on:{click:e.sendMessageHandle}})])])]:[n("div",{staticClass:"empty-room"},[e._v("點選使用者聊天")])]],2)},y=[function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("div",{staticClass:"img-wrapper"},[t("img",{attrs:{src:"https://picsum.photos/40",alt:""}})])}],M={name:"ChatRoom",props:{initalMessages:{type:Array},currentUser:{id:-1},initalConnectingUser:{id:-1,name:"",account:""},isShowChatroom:{type:Boolean,default:!1}},data:function(){return{isSelf:!1,messages:[],sendMessage:"",connectingUser:this.initalConnectingUser}},watch:{initalMessages:function(e){var s=this;this.messages=e,this.$nextTick((function(){var e=s.$refs.messageBody;e.scrollTop=e.lastElementChild.offsetTop}))},initalConnectingUser:function(e){this.connectingUser=e}},methods:{sendMessageHandle:function(){this.$emit("after-send-message",this.sendMessage),this.sendMessage=""},leaveRoomHandle:function(){this.$emit("after-leave-room")}}},w=M,S=(t("3ee8"),Object(p["a"])(w,_,y,!1,null,"222ecb2e",null)),k=S.exports,x={name:"PrivateChatroom",components:{NavSidebar:h["a"],UserMessageListChatRoom:U,ChatRoom:k},data:function(){return{userList:[],messages:[],connectingUser:{},isShowChatroom:!1}},computed:Object(u["a"])({},Object(m["b"])(["currentUser","storeConnectingUser"])),created:function(){this.disconnectSever(),this.connectSever(),(this.storeConnectingUser.length||-1!==this.storeConnectingUser.UserId)&&(this.$socket.emit("privateUser",this.storeConnectingUser.UserId),this.connectingUser=this.storeConnectingUser,this.isShowChatroom=!0,console.log("create : ",this.storeConnectingUser))},destroyed:function(){this.$store.commit("setConnectingUser",{UserId:-1,username:"",account:"",avatar:""})},sockets:{connect:function(){console.log("socket connected")},userInfo:function(e){},privateHistoryMsg:function(e){var s;console.log("privateHistoryMsg",e),(s=this.messages).push.apply(s,d(e))},privateChatMsg:function(e){console.log("privateChatMsg: ",e),this.messages.push(e)},findUser:function(e){},historyMsgForOneUser:function(e){console.log("historyMsgForOneUser: ",e),this.userList=e},unreadMsg:function(e){console.log("unreadMsg: ",e)}},methods:{disconnectSever:function(){this.$socket.disconnect()},connectSever:function(){this.$socket.connect()},afterSendMessageHandle:function(e){this.$socket.emit("userMsg",e)},afterSelectedUserHandle:function(e){this.messages=[],this.$socket.emit("privateUser",e.UserId),this.connectingUser=e,this.isShowChatroom=!0},afterLeaveRoomHandle:function(){this.isShowChatroom=!1}}},$=x,H=(t("1bdc"),Object(p["a"])($,n,a,!1,null,"6382c3b7",null));s["default"]=H.exports},"1bdc":function(e,s,t){"use strict";t("cebe")},"2a0d":function(e,s,t){"use strict";t("064f")},"3ee8":function(e,s,t){"use strict";t("bbbb")},bbbb:function(e,s,t){},cebe:function(e,s,t){},f2ec:function(e,s,t){e.exports=t.p+"img/icon_message.acdd2302.svg"}}]);
//# sourceMappingURL=chunk-4cd0feea.639547a8.js.map