{"version":3,"sources":["webpack:///./src/views/PrivateChatroom.vue?fd70","webpack:///./node_modules/@babel/runtime/helpers/esm/arrayWithoutHoles.js","webpack:///./node_modules/@babel/runtime/helpers/esm/iterableToArray.js","webpack:///./node_modules/@babel/runtime/helpers/esm/nonIterableSpread.js","webpack:///./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js","webpack:///./src/components/UserMessageListChatRoom.vue?e5bc","webpack:///src/components/UserMessageListChatRoom.vue","webpack:///./src/components/UserMessageListChatRoom.vue?fea6","webpack:///./src/components/UserMessageListChatRoom.vue?8158","webpack:///./src/components/ChatRoom.vue?7f25","webpack:///src/components/ChatRoom.vue","webpack:///./src/components/ChatRoom.vue?8417","webpack:///./src/components/ChatRoom.vue?0fc8","webpack:///src/views/PrivateChatroom.vue","webpack:///./src/views/PrivateChatroom.vue?1ded","webpack:///./src/views/PrivateChatroom.vue?19f1","webpack:///./src/views/PrivateChatroom.vue?cfd9","webpack:///./src/components/UserMessageListChatRoom.vue?1f69","webpack:///./src/components/ChatRoom.vue?1bd2","webpack:///./src/assets/icon/icon_message.svg"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","userList","on","afterSelectedUserHandle","connectingUser","messages","currentUser","isShowChatroom","afterSendMessageHandle","afterLeaveRoomHandle","staticRenderFns","_arrayWithoutHoles","arr","Array","isArray","arrayLikeToArray","_iterableToArray","iter","Symbol","iterator","Object","from","_nonIterableSpread","TypeError","_toConsumableArray","arrayWithoutHoles","iterableToArray","unsupportedIterableToArray","nonIterableSpread","_v","_l","user","key","id","$event","selectedUserHandle","avatar","_s","name","account","text","time","props","users","type","methods","console","log","$emit","component","username","leaveRoomHandle","ref","message","ChatId","refInFor","UserId","_m","directives","rawName","value","expression","domProps","target","composing","sendMessage","sendMessageHandle","initalMessages","initalConnectingUser","Boolean","default","data","isSelf","watch","newValue","$nextTick","container","scrollTop","lastElementChild","offsetTop","components","NavSidebar","UserMessageListChatRoom","ChatRoom","computed","created","disconnectSever","connectSever","$socket","emit","storeConnectingUser","destroyed","$store","commit","sockets","connect","userInfo","privateHistoryMsg","event","privateChatMsg","push","findUser","historyMsgForOneUser","unreadMsg","disconnect","module","exports"],"mappings":"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","file":"js/chunk-4cd0feea.639547a8.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"private-room\"},[_c('NavSidebar'),_c('UserMessageListChatRoom',{attrs:{\"users\":_vm.userList},on:{\"after-selected-user\":_vm.afterSelectedUserHandle}}),_c('ChatRoom',{attrs:{\"inital-connecting-user\":_vm.connectingUser,\"inital-messages\":_vm.messages,\"current-user\":_vm.currentUser,\"is-show-chatroom\":_vm.isShowChatroom},on:{\"after-send-message\":_vm.afterSendMessageHandle,\"after-leave-room\":_vm.afterLeaveRoomHandle}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import arrayLikeToArray from \"./arrayLikeToArray.js\";\nexport default function _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}","export default function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}","export default function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}","import arrayWithoutHoles from \"./arrayWithoutHoles.js\";\nimport iterableToArray from \"./iterableToArray.js\";\nimport unsupportedIterableToArray from \"./unsupportedIterableToArray.js\";\nimport nonIterableSpread from \"./nonIterableSpread.js\";\nexport default function _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"chart-room\"},[_c('header',{staticClass:\"header\"},[_c('div',{staticClass:\"title\"},[_vm._v(\"訊息\")]),_c('div',{staticClass:\"add-message\"},[_c('unicon',{attrs:{\"name\":\"add-message\",\"viewBox\":\"0 0 512 512\",\"width\":\"22px\",\"height\":\"22px\"}})],1)]),_c('section',{staticClass:\"user-list\"},_vm._l((_vm.users),function(user){return _c('div',{key:user.id,staticClass:\"user-list-container\",on:{\"click\":function($event){return _vm.selectedUserHandle(user)}}},[_c('div',{staticClass:\"img-wrapper\"},[_c('img',{attrs:{\"src\":user.avatar,\"alt\":\"\"}})]),_c('div',{staticClass:\"info-container\"},[_c('span',{staticClass:\"name\"},[_vm._v(_vm._s(user.name))]),_c('span',{staticClass:\"account\"},[_vm._v(_vm._s(user.account))]),_c('p',{staticClass:\"message\"},[_vm._v(\" \"+_vm._s(user.text)+\" \")])]),_c('div',{staticClass:\"last-time\"},[_vm._v(\" \"+_vm._s(user.time)+\" \")])])}),0)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"chart-room\">\n    <header class=\"header\">\n      <div class=\"title\">訊息</div>\n      <div class=\"add-message\">\n        <unicon\n          name=\"add-message\"\n          viewBox=\"0 0 512 512\"\n          width=\"22px\"\n          height=\"22px\"\n        ></unicon>\n      </div>\n    </header>\n\n    <section class=\"user-list\">\n      <div\n        v-for=\"user in users\"\n        :key=\"user.id\"\n        class=\"user-list-container\"\n        @click=\"selectedUserHandle(user)\"\n      >\n        <div class=\"img-wrapper\">\n          <img :src=\"user.avatar\" alt=\"\" />\n        </div>\n        <div class=\"info-container\">\n          <span class=\"name\">{{ user.name }}</span>\n          <span class=\"account\">{{ user.account }}</span>\n          <p class=\"message\">\n            {{ user.text }}\n          </p>\n        </div>\n        <div class=\"last-time\">\n          {{ user.time }}\n        </div>\n      </div>\n    </section>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'UserMessageListChatRoom',\n  props: {\n    users: {\n      type: Array\n    }\n  },\n  methods: {\n    selectedUserHandle(user) {\n      console.log(user)\n      this.$emit('after-selected-user', user)\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.chart-room {\n  flex-basis: 350px;\n  width: 350px;\n  height: 100%;\n\n  .header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    height: 55px;\n    border-bottom: 1px solid var(--light-gary-clr);\n\n    .title {\n      margin-left: 24px;\n      color: var(--black-clr);\n      font-weight: bold;\n      font-size: 19px;\n    }\n\n    .add-message {\n      margin-right: 24px;\n      cursor: pointer;\n    }\n  }\n\n  .user-list-container {\n    position: relative;\n    display: flex;\n    border-bottom: 1px solid var(--light-gary-clr);\n    cursor: pointer;\n\n    .img-wrapper {\n      overflow: hidden;\n      flex-shrink: 0;\n      margin: 10px 10px 10px 15px;\n      width: 50px;\n      height: 50px;\n      border-radius: 50%;\n      background-color: var(--light-gary-clr);\n\n      &img {\n        width: 100%;\n        height: 100%;\n      }\n    }\n\n    .info-container {\n      overflow: hidden;\n      padding: 10px 0;\n      width: 100%;\n\n      .name {\n        color: var(--black-clr);\n        font-weight: 700;\n        font-size: 0.937rem;\n      }\n\n      .account {\n        color: var(--cement-gary-clr);\n        font-weight: 500;\n        font-size: 0.937rem;\n      }\n\n      .message {\n        overflow: hidden;\n        margin: 0;\n        color: var(--cement-gary-clr);\n        text-overflow: ellipsis;\n        white-space: nowrap;\n        font-weight: 700;\n      }\n    }\n\n    .last-time {\n      position: absolute;\n      top: 10px;\n      right: 15px;\n      color: var(--cement-gary-clr);\n      font-weight: 500;\n      font-size: 0.937rem;\n    }\n  }\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserMessageListChatRoom.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserMessageListChatRoom.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./UserMessageListChatRoom.vue?vue&type=template&id=4a728c92&scoped=true&\"\nimport script from \"./UserMessageListChatRoom.vue?vue&type=script&lang=js&\"\nexport * from \"./UserMessageListChatRoom.vue?vue&type=script&lang=js&\"\nimport style0 from \"./UserMessageListChatRoom.vue?vue&type=style&index=0&id=4a728c92&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4a728c92\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"chat-room\"},[(!_vm.isShowChatroom)?[_c('div',{staticClass:\"empty-room\"},[_vm._v(\"點選使用者聊天\")])]:[_c('header',{staticClass:\"header\"},[_c('div',{staticClass:\"name\"},[_vm._v(_vm._s(_vm.connectingUser.username))]),_c('div',{staticClass:\"account\"},[_vm._v(_vm._s(_vm.connectingUser.account))]),_c('div',{staticClass:\"close\",on:{\"click\":_vm.leaveRoomHandle}},[_c('unicon',{attrs:{\"name\":\"multiply\",\"fill\":\"#ff6600\"}})],1)]),_c('section',{ref:\"messageBody\",staticClass:\"message-body\"},[_c('div',{staticClass:\"fix\"}),_vm._l((_vm.messages),function(message){return _c('div',{key:message.ChatId,ref:\"messageContainer\",refInFor:true,staticClass:\"message-container\"},[(message.UserId === _vm.currentUser.id)?[_c('div',{staticClass:\"self-message-container\"},[_c('div',{staticClass:\"message\"},[_vm._v(_vm._s(message.text))]),_c('div',{staticClass:\"send-time\"},[_vm._v(_vm._s(message.time))])])]:[_c('div',{staticClass:\"other-message-container\"},[_vm._m(0,true),_c('div',{staticClass:\"info-container\"},[_c('div',{staticClass:\"message\"},[_vm._v(_vm._s(message.text))]),_c('div',{staticClass:\"send-time\"},[_vm._v(_vm._s(message.time))])])])]],2)})],2),_c('section',{staticClass:\"send-message\"},[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.sendMessage),expression:\"sendMessage\"}],staticClass:\"text-input\",attrs:{\"type\":\"text\",\"name\":\"\",\"placeholder\":\"輸入訊息...\"},domProps:{\"value\":(_vm.sendMessage)},on:{\"input\":function($event){if($event.target.composing){ return; }_vm.sendMessage=$event.target.value}}}),_c('button',{staticClass:\"send-btn\",attrs:{\"type\":\"submit\"}},[_c('img',{attrs:{\"src\":require(\"../assets/icon/icon_message.svg\"),\"alt\":\"send\"},on:{\"click\":_vm.sendMessageHandle}})])])]],2)}\nvar staticRenderFns = [function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"img-wrapper\"},[_c('img',{attrs:{\"src\":\"https://picsum.photos/40\",\"alt\":\"\"}})])}]\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"chat-room\">\n    <template v-if=\"!isShowChatroom\">\n      <div class=\"empty-room\">點選使用者聊天</div>\n    </template>\n    <template v-else>\n      <header class=\"header\">\n        <div class=\"name\">{{ connectingUser.username }}</div>\n        <div class=\"account\">{{ connectingUser.account }}</div>\n        <div class=\"close\" @click=\"leaveRoomHandle\">\n          <unicon name=\"multiply\" fill=\"#ff6600\"></unicon>\n        </div>\n      </header>\n\n      <section ref=\"messageBody\" class=\"message-body\">\n        <div class=\"fix\"></div>\n        <div\n          ref=\"messageContainer\"\n          v-for=\"message in messages\"\n          :key=\"message.ChatId\"\n          class=\"message-container\"\n        >\n          <template v-if=\"message.UserId === currentUser.id\">\n            <div class=\"self-message-container\">\n              <div class=\"message\">{{ message.text }}</div>\n              <div class=\"send-time\">{{ message.time }}</div>\n            </div>\n          </template>\n          <template v-else>\n            <div class=\"other-message-container\">\n              <div class=\"img-wrapper\">\n                <img src=\"https://picsum.photos/40\" alt=\"\" />\n              </div>\n              <div class=\"info-container\">\n                <div class=\"message\">{{ message.text }}</div>\n                <div class=\"send-time\">{{ message.time }}</div>\n              </div>\n            </div>\n          </template>\n        </div>\n      </section>\n\n      <section class=\"send-message\">\n        <input\n          v-model=\"sendMessage\"\n          type=\"text\"\n          name=\"\"\n          placeholder=\"輸入訊息...\"\n          class=\"text-input\"\n        />\n        <button type=\"submit\" class=\"send-btn\">\n          <img\n            src=\"../assets/icon/icon_message.svg\"\n            alt=\"send\"\n            @click=\"sendMessageHandle\"\n          />\n        </button>\n      </section>\n    </template>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: 'ChatRoom',\n  props: {\n    initalMessages: {\n      type: Array\n    },\n    currentUser: {\n      id: -1\n    },\n    initalConnectingUser: {\n      id: -1,\n      name: '',\n      account: ''\n    },\n    isShowChatroom: {\n      type: Boolean,\n      default: false\n    }\n  },\n  data() {\n    return {\n      isSelf: false,\n      messages: [],\n      sendMessage: '',\n      connectingUser: this.initalConnectingUser\n    }\n  },\n  watch: {\n    initalMessages(newValue) {\n      this.messages = newValue\n\n      this.$nextTick(() => {\n        const container = this.$refs.messageBody\n\n        container.scrollTop = container.lastElementChild.offsetTop\n      })\n    },\n    initalConnectingUser(newValue) {\n      this.connectingUser = newValue\n    }\n  },\n  methods: {\n    sendMessageHandle() {\n      this.$emit('after-send-message', this.sendMessage)\n      this.sendMessage = ''\n    },\n    leaveRoomHandle() {\n      this.$emit('after-leave-room')\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.chat-room {\n  position: relative;\n  overflow: hidden;\n  flex-grow: 1;\n  padding-bottom: 55px;\n  height: 100%;\n  border-left: 1px solid var(--light-gary-clr);\n\n  .header {\n    position: relative;\n    display: flex;\n    flex-direction: column;\n    padding-left: 24px;\n    height: 55px;\n    border-bottom: 1px solid var(--light-gary-clr);\n    .name {\n      color: var(--black-clr);\n      font-weight: 700;\n      font-size: 19px;\n    }\n\n    .account {\n      color: var(--cement-gary-clr);\n      font-weight: 500;\n      font-size: 0.937rem;\n    }\n\n    .close {\n      position: absolute;\n      top: 50%;\n      right: 0;\n      transform: translate(-50%, -50%);\n    }\n  }\n\n  .message-body {\n    display: flex;\n    overflow-y: scroll;\n    flex-direction: column;\n    padding-bottom: 55px;\n    height: 100%;\n\n    &::-webkit-scrollbar {\n      width: 0;\n    }\n\n    .fix {\n      flex: 1 1 auto;\n    }\n\n    .self-message-container {\n      display: flex;\n      align-items: flex-end;\n      flex-direction: column;\n      margin-bottom: 10px;\n      width: 100%;\n\n      .message {\n        margin-right: 15px;\n        padding: 10px 15px;\n        max-width: 70%;\n        border-radius: 40px 40px 0 40px;\n        background: var(--primary-clr);\n        color: white;\n      }\n\n      .send-time {\n        margin-right: 15px;\n        color: var(--cement-gary-clr);\n        font-size: 13px;\n      }\n    }\n\n    .other-message-container {\n      display: flex;\n      align-items: flex-start;\n      margin-bottom: 10px;\n      width: 100%;\n\n      .img-wrapper {\n        overflow: hidden;\n        margin: 0 10px 10px 15px;\n        width: 40px;\n        height: 40px;\n        border-radius: 50%;\n        background-color: var(--light-gary-clr);\n\n        &img {\n          width: 100%;\n          height: 100%;\n        }\n      }\n\n      .info-container {\n        .message {\n          padding: 10px 15px;\n          border-radius: 40px 40px 40px 0;\n          background: var(--dialogue-blue-clr);\n        }\n\n        .send-time {\n          color: var(--cement-gary-clr);\n          font-size: 13px;\n        }\n      }\n    }\n  }\n\n  .send-message {\n    position: absolute;\n    right: 0;\n    bottom: 0;\n    left: 0;\n    display: flex;\n    align-items: center;\n    justify-content: space-evenly;\n    height: 55px;\n    background-color: #fff;\n\n    .text-input {\n      padding: 10px 20px;\n      width: 90%;\n      border: none;\n      border-radius: 50px;\n      background-color: var(--dialogue-blue-clr);\n      color: var(--cement-gary-clr);\n\n      &:focus {\n        outline: 0;\n        box-shadow: none;\n      }\n    }\n\n    .send-btn {\n      margin-left: 1.5rem;\n      border: none;\n      background: none;\n    }\n  }\n\n  .empty-room {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: 100%;\n    color: var(--black-clr);\n    font-weight: 700;\n  }\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChatRoom.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChatRoom.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./ChatRoom.vue?vue&type=template&id=222ecb2e&scoped=true&\"\nimport script from \"./ChatRoom.vue?vue&type=script&lang=js&\"\nexport * from \"./ChatRoom.vue?vue&type=script&lang=js&\"\nimport style0 from \"./ChatRoom.vue?vue&type=style&index=0&id=222ecb2e&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"222ecb2e\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div class=\"private-room\">\n    <NavSidebar />\n\n    <UserMessageListChatRoom\n      :users=\"userList\"\n      @after-selected-user=\"afterSelectedUserHandle\"\n    />\n\n    <ChatRoom\n      :inital-connecting-user=\"connectingUser\"\n      :inital-messages=\"messages\"\n      :current-user=\"currentUser\"\n      :is-show-chatroom=\"isShowChatroom\"\n      @after-send-message=\"afterSendMessageHandle\"\n      @after-leave-room=\"afterLeaveRoomHandle\"\n    />\n  </div>\n</template>\n\n<script>\nimport { mapState } from 'vuex'\nimport NavSidebar from '../components/NavSidebar'\nimport UserMessageListChatRoom from '../components/UserMessageListChatRoom'\nimport ChatRoom from '../components/ChatRoom'\n\nexport default {\n  name: 'PrivateChatroom',\n  components: {\n    NavSidebar,\n    UserMessageListChatRoom,\n    ChatRoom\n  },\n  data() {\n    return {\n      userList: [],\n      messages: [],\n      connectingUser: {},\n      isShowChatroom: false\n    }\n  },\n  computed: {\n    ...mapState(['currentUser', 'storeConnectingUser'])\n  },\n  created() {\n    this.disconnectSever()\n    this.connectSever()\n\n    if (\n      this.storeConnectingUser.length ||\n      this.storeConnectingUser.UserId !== -1\n    ) {\n      this.$socket.emit('privateUser', this.storeConnectingUser.UserId)\n      this.connectingUser = this.storeConnectingUser\n      this.isShowChatroom = true\n      console.log('create : ', this.storeConnectingUser)\n    }\n  },\n  destroyed() {\n    this.$store.commit('setConnectingUser', {\n      UserId: -1,\n      username: '',\n      account: '',\n      avatar: ''\n    })\n  },\n  sockets: {\n    connect() {\n      console.log('socket connected')\n    },\n    userInfo(event) {\n      // console.log('user info: ', event)\n    },\n    privateHistoryMsg(event) {\n      console.log('privateHistoryMsg', event)\n      this.messages.push(...event)\n    },\n    privateChatMsg(event) {\n      console.log('privateChatMsg: ', event)\n      this.messages.push(event)\n    },\n    findUser(event) {\n      // console.log('find user: ', event)\n    },\n    historyMsgForOneUser(users) {\n      console.log('historyMsgForOneUser: ', users)\n      this.userList = users\n    },\n    unreadMsg(data) {\n      console.log('unreadMsg: ', data)\n    }\n  },\n  methods: {\n    disconnectSever() {\n      this.$socket.disconnect()\n    },\n    connectSever() {\n      this.$socket.connect()\n    },\n    afterSendMessageHandle(message) {\n      // console.log(message)\n      this.$socket.emit('userMsg', message)\n    },\n    afterSelectedUserHandle(user) {\n      // 跟選擇到的使用者建立 Channel\n      this.messages = []\n\n      this.$socket.emit('privateUser', user.UserId)\n      this.connectingUser = user\n      // console.log(user.name)\n      // this.$socket.emit('privateUser', 'user2')\n      this.isShowChatroom = true\n    },\n    afterLeaveRoomHandle() {\n      this.isShowChatroom = false\n    }\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.private-room {\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  height: 100%;\n}\n</style>\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PrivateChatroom.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PrivateChatroom.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PrivateChatroom.vue?vue&type=template&id=6382c3b7&scoped=true&\"\nimport script from \"./PrivateChatroom.vue?vue&type=script&lang=js&\"\nexport * from \"./PrivateChatroom.vue?vue&type=script&lang=js&\"\nimport style0 from \"./PrivateChatroom.vue?vue&type=style&index=0&id=6382c3b7&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"6382c3b7\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PrivateChatroom.vue?vue&type=style&index=0&id=6382c3b7&lang=scss&scoped=true&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserMessageListChatRoom.vue?vue&type=style&index=0&id=4a728c92&lang=scss&scoped=true&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./ChatRoom.vue?vue&type=style&index=0&id=222ecb2e&lang=scss&scoped=true&\"","module.exports = __webpack_public_path__ + \"img/icon_message.acdd2302.svg\";"],"sourceRoot":""}