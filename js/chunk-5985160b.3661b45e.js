(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5985160b"],{"0217":function(t,e,a){"use strict";a("3f00")},"3a4c":function(t,e,a){t.exports=a.p+"img/icon_close.ef4b5d63.svg"},"3bb6":function(t,e,a){"use strict";var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"nav-container"},[s("div",{staticClass:"nav-wrapper"},[t._m(0),s("nav",[s("ul",[s("li",[s("router-link",{attrs:{to:"/admin/tweets",custom:""},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.navigate,i=e.isActive,r=e.isExactActive;return[s("a",{class:[i&&"router-link-active",r&&"router-link-exact-active"],on:{click:n}},[s("img",{attrs:{src:[a(i?"c35a":"af0c")],alt:""}}),s("span",[t._v("推文清單")])])]}}])})],1),s("li",[s("router-link",{attrs:{to:{name:"admin-users"},custom:""},scopedSlots:t._u([{key:"default",fn:function(e){var n=e.navigate,i=e.isActive,r=e.isExactActive;return[s("a",{class:[i&&"router-link-active",r&&"router-link-exact-active"],on:{click:n}},[s("img",{attrs:{src:[a(i?"98b3":"a866")],alt:""}}),s("span",[t._v("使用者列表")])])]}}])})],1)])]),s("div",{staticClass:"logout"},[s("button",{staticClass:"btn",on:{click:t.logout}},[s("img",{attrs:{src:a("a3c9"),alt:""}}),s("span",[t._v("登出")])])])])])},n=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"logo"},[s("img",{attrs:{src:a("808a"),alt:""}})])}],i={name:"AdminSiderBar",data:function(){return{isActive:!1}},methods:{logout:function(){this.$store.commit("revokeCurrentUser"),this.$router.push("/admin")}}},r=i,c=(a("c135"),a("2877")),o=Object(c["a"])(r,s,n,!1,null,"7a328185",null);e["a"]=o.exports},"3f00":function(t,e,a){},"573b":function(t,e,a){},a40d:function(t,e,a){"use strict";a("573b")},be6c:function(t,e,a){"use strict";var s=a("2fa3");e["a"]={getTweets:function(){return s["b"].get("/tweets")},deleteTweet:function(t){var e=t.tweetId;return s["b"].delete("/admin/tweets/".concat(e))},getUsers:function(){return s["b"].get("/admin/users")}}},c135:function(t,e,a){"use strict";a("ec5c")},ec5c:function(t,e,a){},fa6a:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wrapper"},[a("AdminSidebar",{staticClass:"admin-sidebar"}),a("div",{staticClass:"center-column"},[t.isLoading?a("Spinner"):[a("div",{staticClass:"header"},[a("div",{staticClass:"header-title"},[t._v("推文清單")])]),a("div",{staticClass:"tweet-list"},t._l(t.tweets,(function(e){return a("AminTweetList",{key:e.id,attrs:{"initial-tweet":e},on:{"after-delete-tweet":t.handleDeleteTweet}})})),1)]],2)],1)},n=[],i=a("1da1"),r=(a("4de4"),a("96cf"),a("3bb6")),c=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"cell cell-container"},[s("img",{staticClass:"avatar",attrs:{src:t.tweet.user.avatar}}),t._e(),s("div",{staticClass:"info-container"},[s("span",{staticClass:"name"},[t._v(t._s(t.tweet.user.name))]),s("span",{staticClass:"tag"},[t._v("@"+t._s(t.tweet.user.account))]),s("span",{staticClass:"time"},[t._v(t._s(t._f("fromNow")(t.tweet.createdAt)))]),s("p",{staticClass:"content"},[t._v(" "+t._s(t._f("countText")(t.tweet.description))+" ")])]),s("button",{staticClass:"btn shadow-none",attrs:{type:"button"},on:{click:function(e){return e.preventDefault(),e.stopPropagation(),t.deleteTweet(t.tweet.id)}}},[s("img",{attrs:{src:a("3a4c"),alt:""}})])])},o=[],u=a("5530"),l=a("be6c"),d=a("2fa3"),f=a("2708"),w={mixins:[f["c"],f["b"],f["a"]],name:"AdminTweetList",props:{initialTweet:{type:Object,required:!0}},data:function(){return{isProcessing:!1,tweet:this.initialTweet}},watch:{initialTweet:function(t){this.tweet=Object(u["a"])(Object(u["a"])({},this.tweet),t)}},methods:{deleteTweet:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function a(){var s,n;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,e.isProcessing=!0,a.next=4,l["a"].deleteTweet({tweetId:t});case 4:if(s=a.sent,n=s.data,"success"===n.status){a.next=8;break}throw new Error(n.message);case 8:d["a"].fire({icon:"success",title:"推文已刪除！"}),e.isProcessing=!1,e.$emit("after-delete-tweet",e.tweet.id),a.next=17;break;case 13:a.prev=13,a.t0=a["catch"](0),e.isProcessing=!1,d["a"].fire({icon:"error",title:"無法刪除: ".concat(a.t0.message)});case 17:case"end":return a.stop()}}),a,null,[[0,13]])})))()}}},v=w,m=(a("0217"),a("2877")),p=Object(m["a"])(v,c,o,!1,null,"4050abfc",null),b=p.exports,g=a("2375"),h={name:"AdminTweets",components:{AdminSidebar:r["a"],AminTweetList:b,Spinner:g["a"]},data:function(){return{tweets:[],isLoading:!0}},created:function(){this.fetchTweets()},methods:{fetchTweets:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var a,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,l["a"].getTweets();case 3:if(a=e.sent,s=a.data,"error"!==s.status){e.next=7;break}throw new Error(s.status);case 7:t.tweets=s,t.isLoading=!1,e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](0),d["a"].fire({icon:"error",title:"無法取得推文: ".concat(e.t0.message)}),t.isLoading=!1;case 15:case"end":return e.stop()}}),e,null,[[0,11]])})))()},handleDeleteTweet:function(t){this.tweets=this.tweets.filter((function(e){return e.id!==t}))}}},_=h,k=(a("a40d"),Object(m["a"])(_,s,n,!1,null,"d21ab616",null));e["default"]=k.exports}}]);
//# sourceMappingURL=chunk-5985160b.3661b45e.js.map