(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-60b73dcf"],{"0418":function(e,t,a){"use strict";var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("header",[e.enableBackBtn?a("unicon",{attrs:{name:"cst-back-icon",fill:"black",viewBox:"0 0 64 64",width:"24px",height:"24px"},on:{click:e.handleBack}}):e._e(),a("span",{staticClass:"title",class:{"ml-0":e.enableBackBtn}},[e._v(e._s(e.title))])],1)])},r=[],n={name:"Header",props:{title:{type:String,default:""},enableBackBtn:{type:Boolean,default:!1}},methods:{handleBack:function(){this.$router.go(-1)}}},i=n,c=(a("132f"),a("2877")),o=Object(c["a"])(i,s,r,!1,null,"7141969e",null);t["a"]=o.exports},"132f":function(e,t,a){"use strict";a("275b")},"275b":function(e,t,a){},"3b14":function(e,t,a){},"6ee3":function(e,t,a){},"939f":function(e,t,a){"use strict";a("3b14")},"952b":function(e,t,a){"use strict";a("6ee3")},c766:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"setting-container"},[a("NavSidebar"),a("UserSettingForm",{attrs:{initialUserData:e.userData,isProcessing:e.isProcessing},on:{"after-submit":e.handleAfterSubmit}})],1)},r=[],n=a("1da1"),i=a("5530"),c=(a("96cf"),a("b0c0"),a("bb41")),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"setting"},[a("Header",{attrs:{title:"帳戶設定"}}),a("div",{staticClass:"setting-container"},[a("form",{on:{submit:function(t){return t.preventDefault(),t.stopPropagation(),e.handleSubmit(t)}}},[a("div",{staticClass:"input-wrapper"},[a("label",{staticClass:"text"},[e._v("帳號")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.userData.account,expression:"userData.account"}],attrs:{type:"text",autofocus:""},domProps:{value:e.userData.account},on:{input:function(t){t.target.composing||e.$set(e.userData,"account",t.target.value)}}})]),a("div",{staticClass:"input-wrapper"},[a("label",{staticClass:"text"},[e._v("名稱")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.userData.name,expression:"userData.name"}],attrs:{type:"text"},domProps:{value:e.userData.name},on:{input:function(t){t.target.composing||e.$set(e.userData,"name",t.target.value)}}})]),a("div",{staticClass:"input-wrapper"},[a("label",{staticClass:"text"},[e._v("Email")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.userData.email,expression:"userData.email"}],attrs:{type:"text"},domProps:{value:e.userData.email},on:{input:function(t){t.target.composing||e.$set(e.userData,"email",t.target.value)}}})]),a("div",{staticClass:"input-wrapper"},[a("label",{staticClass:"text"},[e._v("密碼")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.userData.password,expression:"userData.password"}],attrs:{type:"password"},domProps:{value:e.userData.password},on:{input:function(t){t.target.composing||e.$set(e.userData,"password",t.target.value)}}})]),a("div",{staticClass:"input-wrapper"},[a("label",{staticClass:"text"},[e._v("密碼確認")]),a("input",{directives:[{name:"model",rawName:"v-model",value:e.userData.checkPassword,expression:"userData.checkPassword"}],attrs:{type:"password"},domProps:{value:e.userData.checkPassword},on:{input:function(t){t.target.composing||e.$set(e.userData,"checkPassword",t.target.value)}}})]),a("div",{staticClass:"btn-wrapper"},[a("button",{staticClass:"btn",attrs:{type:"submit",disabled:e.isProcessing}},[e._v("儲存 ")])])])])],1)},u=[],l=a("0418"),d=a("2fa3"),m={name:"UserSettingForm",components:{Header:l["a"]},props:{initialUserData:{type:Object,default:function(){return{id:-1,account:"",name:"",email:"",password:"",checkPassword:""}}},isProcessing:{type:Boolean,default:!1}},data:function(){return{userData:Object(i["a"])({},this.initialUserData)}},watch:{initialUserData:function(e){this.userData=Object(i["a"])(Object(i["a"])({},this.userData),e)}},methods:{handleSubmit:function(){if(this.userData.checkPassword!==this.userData.password)return d["a"].fire({icon:"warning",title:"請確認密碼欄位相同"}),this.userData.checkPassword="",void(this.userData.password="");this.$emit("after-submit",{account:this.userData.account,name:this.userData.name,email:this.userData.email,password:this.userData.password,checkPassword:this.userData.checkPassword})}}},p=m,f=(a("939f"),a("2877")),v=Object(f["a"])(p,o,u,!1,null,"055853c7",null),h=v.exports,b=a("4cce"),w=a("2f62"),g={name:"UserAccountSetting",components:{NavSidebar:c["a"],UserSettingForm:h},data:function(){return{userData:{id:-1,account:"",name:"",email:"",password:"",checkPassword:""},isProcessing:!1}},created:function(){this.fetchUserData()},computed:Object(i["a"])({},Object(w["b"])(["currentUser"])),methods:{fetchUserData:function(){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:try{e.userData=Object(i["a"])(Object(i["a"])({},e.userData),{},{id:e.currentUser.id,account:e.currentUser.account,name:e.currentUser.name,email:e.currentUser.email}),console.log("userData",e.userData)}catch(a){d["a"].fire({icon:"error",title:"無法取得使用者資訊：".concat(a.message)})}case 1:case"end":return t.stop()}}),t)})))()},handleAfterSubmit:function(e){var t=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){var s,r,n,c,o,u,l,m,p;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return s=e.account,r=e.name,n=e.email,c=e.password,o=e.checkPassword,a.prev=1,t.isProcessing=!0,u={account:s,name:r,email:n,password:c,checkPassword:o},l=t.userData.id,console.log(l,u),t.isProcessing=!0,a.next=9,b["a"].editAccount(l,Object(i["a"])({},u));case 9:if(m=a.sent,p=m.data,"success"===p.status){a.next=13;break}throw new Error(p.message);case 13:t.$store.commit("setCurrentUser",{userId:l,account:s,name:r,email:n}),d["a"].fire({icon:"success",title:"更新完成：".concat(p.message)}),t.isProcessing=!1,a.next=21;break;case 18:a.prev=18,a.t0=a["catch"](1),d["a"].fire({icon:"error",title:"無法更新用戶資訊: ".concat(a.t0.message)});case 21:t.isProcessing=!1;case 22:case"end":return a.stop()}}),a,null,[[1,18]])})))()}}},D=g,k=(a("952b"),Object(f["a"])(D,s,r,!1,null,"3b5eba00",null));t["default"]=k.exports}}]);
//# sourceMappingURL=chunk-60b73dcf.95787557.js.map